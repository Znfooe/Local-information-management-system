import { createHotContext as __vite__createHotContext } from "/@vite/client";import.meta.hot = __vite__createHotContext("/src/pages/AiAgent.tsx");import __vite__cjsImport0_react_jsxDevRuntime from "/node_modules/.vite/deps/react_jsx-dev-runtime.js?v=35fb60bd"; const jsxDEV = __vite__cjsImport0_react_jsxDevRuntime["jsxDEV"];
var _s = $RefreshSig$();
import __vite__cjsImport1_react from "/node_modules/.vite/deps/react.js?v=35fb60bd"; const useState = __vite__cjsImport1_react["useState"]; const useRef = __vite__cjsImport1_react["useRef"]; const useEffect = __vite__cjsImport1_react["useEffect"];
import { useTranslation } from "/node_modules/.vite/deps/react-i18next.js?v=35fb60bd";
import { toast } from "/node_modules/.vite/deps/sonner.js?v=35fb60bd";
import { Button } from "/src/components/ui/button.tsx";
import { Input } from "/src/components/ui/input.tsx";
import { ScrollArea } from "/src/components/ui/scroll-area.tsx";
import { Card } from "/src/components/ui/card.tsx";
import { Send, Bot, User, Settings2 } from "/node_modules/.vite/deps/lucide-react.js?v=35fb60bd";
import axios from "/node_modules/.vite/deps/axios.js?v=35fb60bd";
import { db } from "/src/lib/db.ts";
import {
  Dialog,
  DialogContent,
  DialogHeader,
  DialogTitle,
  DialogTrigger,
  DialogDescription
} from "/src/components/ui/dialog.tsx";
import { Label } from "/src/components/ui/label.tsx";
import { Textarea } from "/src/components/ui/textarea.tsx";
export default function AiAgent() {
  _s();
  const { t } = useTranslation();
  const [messages, setMessages] = useState([]);
  const [input, setInput] = useState("");
  const [isLoading, setIsLoading] = useState(false);
  const scrollRef = useRef(null);
  const [systemPrompt, setSystemPrompt] = useState("你是一个乐于助人的AI助手。");
  const [apiKey, setApiKey] = useState("12b3cf51ba064a46b68ecc6bbd5b31ec.kwa9yPoUIxDxJ16J");
  const [model, setModel] = useState("glm-4-flash");
  useEffect(() => {
    const loadSettings = async () => {
      const settings = await db.getSettings();
      if (settings.apiKey) setApiKey(settings.apiKey);
      if (settings.model) setModel(settings.model);
      if (settings.systemPrompt) setSystemPrompt(settings.systemPrompt);
    };
    loadSettings();
  }, []);
  const saveConfig = async () => {
    if (!apiKey.trim()) {
      toast.error("API Key cannot be empty!");
      return;
    }
    try {
      await db.saveSettings({ apiKey, model, systemPrompt });
      toast.success("Configuration saved successfully!");
    } catch (error) {
      console.error("Save config error:", error);
      toast.error("Failed to save configuration.");
    }
  };
  useEffect(() => {
    if (scrollRef.current) {
      scrollRef.current.scrollIntoView({ behavior: "smooth" });
    }
  }, [messages]);
  const handleSend = async () => {
    if (!input.trim()) return;
    if (!apiKey) {
      toast.error("Please set API Key first!");
      return;
    }
    const userMsg = { role: "user", content: input };
    setMessages((prev) => [...prev, userMsg]);
    setInput("");
    setIsLoading(true);
    try {
      const conversation = [
        { role: "system", content: systemPrompt },
        ...messages,
        userMsg
      ];
      const response = await axios.post(
        "https://open.bigmodel.cn/api/paas/v4/chat/completions",
        {
          model,
          messages: conversation,
          stream: false
        },
        {
          headers: {
            "Authorization": `Bearer ${apiKey}`,
            "Content-Type": "application/json"
          }
        }
      );
      const aiMsg = {
        role: "assistant",
        content: response.data.choices[0].message.content
      };
      setMessages((prev) => [...prev, aiMsg]);
    } catch (error) {
      console.error("AI Error:", error);
      toast.error("AI Request Failed");
      const errorMsg = {
        role: "assistant",
        content: `Error: ${error.response?.data?.error?.message || error.message}`
      };
      setMessages((prev) => [...prev, errorMsg]);
    } finally {
      setIsLoading(false);
    }
  };
  return /* @__PURE__ */ jsxDEV("div", { className: "flex flex-col h-full space-y-4", children: [
    /* @__PURE__ */ jsxDEV("div", { className: "flex items-center justify-between border-b pb-4", children: [
      /* @__PURE__ */ jsxDEV("h2", { className: "text-2xl font-bold flex items-center gap-2", children: [
        /* @__PURE__ */ jsxDEV(Bot, { className: "h-6 w-6" }, void 0, false, {
          fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
          lineNumber: 128,
          columnNumber: 11
        }, this),
        " ",
        t("nav.ai")
      ] }, void 0, true, {
        fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
        lineNumber: 127,
        columnNumber: 9
      }, this),
      /* @__PURE__ */ jsxDEV(Dialog, { children: [
        /* @__PURE__ */ jsxDEV(DialogTrigger, { asChild: true, children: /* @__PURE__ */ jsxDEV(Button, { variant: "outline", size: "sm", children: [
          /* @__PURE__ */ jsxDEV(Settings2, { className: "h-4 w-4 mr-2" }, void 0, false, {
            fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
            lineNumber: 134,
            columnNumber: 15
          }, this),
          " Agent Settings"
        ] }, void 0, true, {
          fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
          lineNumber: 133,
          columnNumber: 13
        }, this) }, void 0, false, {
          fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
          lineNumber: 132,
          columnNumber: 11
        }, this),
        /* @__PURE__ */ jsxDEV(DialogContent, { children: [
          /* @__PURE__ */ jsxDEV(DialogHeader, { children: [
            /* @__PURE__ */ jsxDEV(DialogTitle, { children: "Agent Configuration (Zhipu AI)" }, void 0, false, {
              fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
              lineNumber: 139,
              columnNumber: 15
            }, this),
            /* @__PURE__ */ jsxDEV(DialogDescription, { children: "Configure your AI model settings and API key here." }, void 0, false, {
              fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
              lineNumber: 140,
              columnNumber: 15
            }, this)
          ] }, void 0, true, {
            fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
            lineNumber: 138,
            columnNumber: 13
          }, this),
          /* @__PURE__ */ jsxDEV("div", { className: "space-y-4 py-4", children: [
            /* @__PURE__ */ jsxDEV("div", { className: "grid gap-2", children: [
              /* @__PURE__ */ jsxDEV(Label, { children: "System Prompt (Persona)" }, void 0, false, {
                fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
                lineNumber: 146,
                columnNumber: 17
              }, this),
              /* @__PURE__ */ jsxDEV(
                Textarea,
                {
                  value: systemPrompt,
                  onChange: (e) => setSystemPrompt(e.target.value),
                  placeholder: "Define how the agent behaves...",
                  className: "h-24"
                },
                void 0,
                false,
                {
                  fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
                  lineNumber: 147,
                  columnNumber: 17
                },
                this
              )
            ] }, void 0, true, {
              fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
              lineNumber: 145,
              columnNumber: 15
            }, this),
            /* @__PURE__ */ jsxDEV("div", { className: "grid gap-2", children: [
              /* @__PURE__ */ jsxDEV(Label, { children: "API Key (GLM)" }, void 0, false, {
                fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
                lineNumber: 155,
                columnNumber: 17
              }, this),
              /* @__PURE__ */ jsxDEV(
                Input,
                {
                  value: apiKey,
                  onChange: (e) => setApiKey(e.target.value),
                  type: "password",
                  placeholder: "Enter your Zhipu API Key"
                },
                void 0,
                false,
                {
                  fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
                  lineNumber: 156,
                  columnNumber: 17
                },
                this
              ),
              /* @__PURE__ */ jsxDEV("p", { className: "text-xs text-muted-foreground", children: [
                "Get key from: ",
                /* @__PURE__ */ jsxDEV("a", { href: "https://open.bigmodel.cn/", target: "_blank", className: "underline", children: "open.bigmodel.cn" }, void 0, false, {
                  fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
                  lineNumber: 163,
                  columnNumber: 33
                }, this)
              ] }, void 0, true, {
                fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
                lineNumber: 162,
                columnNumber: 17
              }, this)
            ] }, void 0, true, {
              fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
              lineNumber: 154,
              columnNumber: 15
            }, this),
            /* @__PURE__ */ jsxDEV("div", { className: "grid gap-2", children: [
              /* @__PURE__ */ jsxDEV(Label, { children: "Model Name" }, void 0, false, {
                fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
                lineNumber: 167,
                columnNumber: 17
              }, this),
              /* @__PURE__ */ jsxDEV(
                Input,
                {
                  value: model,
                  onChange: (e) => setModel(e.target.value),
                  placeholder: "e.g. glm-4-flash"
                },
                void 0,
                false,
                {
                  fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
                  lineNumber: 168,
                  columnNumber: 17
                },
                this
              )
            ] }, void 0, true, {
              fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
              lineNumber: 166,
              columnNumber: 15
            }, this),
            /* @__PURE__ */ jsxDEV(Button, { onClick: saveConfig, className: "w-full", children: "Save Configuration" }, void 0, false, {
              fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
              lineNumber: 174,
              columnNumber: 15
            }, this)
          ] }, void 0, true, {
            fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
            lineNumber: 144,
            columnNumber: 13
          }, this)
        ] }, void 0, true, {
          fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
          lineNumber: 137,
          columnNumber: 11
        }, this)
      ] }, void 0, true, {
        fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
        lineNumber: 131,
        columnNumber: 9
      }, this)
    ] }, void 0, true, {
      fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
      lineNumber: 126,
      columnNumber: 7
    }, this),
    /* @__PURE__ */ jsxDEV(Card, { className: "flex-1 p-4 overflow-hidden flex flex-col bg-muted/30", children: [
      /* @__PURE__ */ jsxDEV(ScrollArea, { className: "flex-1 pr-4", children: /* @__PURE__ */ jsxDEV("div", { className: "space-y-4", children: [
        messages.length === 0 && /* @__PURE__ */ jsxDEV("div", { className: "text-center text-muted-foreground mt-20", children: [
          /* @__PURE__ */ jsxDEV(Bot, { className: "h-12 w-12 mx-auto mb-4 opacity-50" }, void 0, false, {
            fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
            lineNumber: 185,
            columnNumber: 17
          }, this),
          /* @__PURE__ */ jsxDEV("p", { children: "Start a conversation with your AI Agent." }, void 0, false, {
            fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
            lineNumber: 186,
            columnNumber: 17
          }, this)
        ] }, void 0, true, {
          fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
          lineNumber: 184,
          columnNumber: 13
        }, this),
        messages.map(
          (msg, i) => /* @__PURE__ */ jsxDEV(
            "div",
            {
              className: `flex ${msg.role === "user" ? "justify-end" : "justify-start"}`,
              children: /* @__PURE__ */ jsxDEV(
                "div",
                {
                  className: `flex gap-3 max-w-[80%] ${msg.role === "user" ? "flex-row-reverse" : "flex-row"}`,
                  children: [
                    /* @__PURE__ */ jsxDEV("div", { className: `h-8 w-8 rounded-full flex items-center justify-center shrink-0 ${msg.role === "user" ? "bg-primary text-primary-foreground" : "bg-secondary"}`, children: msg.role === "user" ? /* @__PURE__ */ jsxDEV(User, { className: "h-5 w-5" }, void 0, false, {
                      fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
                      lineNumber: 204,
                      columnNumber: 44
                    }, this) : /* @__PURE__ */ jsxDEV(Bot, { className: "h-5 w-5" }, void 0, false, {
                      fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
                      lineNumber: 204,
                      columnNumber: 75
                    }, this) }, void 0, false, {
                      fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
                      lineNumber: 201,
                      columnNumber: 19
                    }, this),
                    /* @__PURE__ */ jsxDEV(
                      "div",
                      {
                        className: `p-3 rounded-lg text-sm whitespace-pre-wrap ${msg.role === "user" ? "bg-primary text-primary-foreground" : "bg-card border shadow-sm"}`,
                        children: msg.content
                      },
                      void 0,
                      false,
                      {
                        fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
                        lineNumber: 206,
                        columnNumber: 19
                      },
                      this
                    )
                  ]
                },
                void 0,
                true,
                {
                  fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
                  lineNumber: 196,
                  columnNumber: 17
                },
                this
              )
            },
            i,
            false,
            {
              fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
              lineNumber: 190,
              columnNumber: 13
            },
            this
          )
        ),
        isLoading && /* @__PURE__ */ jsxDEV("div", { className: "flex justify-start", children: /* @__PURE__ */ jsxDEV("div", { className: "bg-card border p-3 rounded-lg text-sm shadow-sm", children: "Thinking..." }, void 0, false, {
          fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
          lineNumber: 220,
          columnNumber: 18
        }, this) }, void 0, false, {
          fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
          lineNumber: 219,
          columnNumber: 13
        }, this),
        /* @__PURE__ */ jsxDEV("div", { ref: scrollRef }, void 0, false, {
          fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
          lineNumber: 225,
          columnNumber: 13
        }, this)
      ] }, void 0, true, {
        fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
        lineNumber: 182,
        columnNumber: 11
      }, this) }, void 0, false, {
        fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
        lineNumber: 181,
        columnNumber: 9
      }, this),
      /* @__PURE__ */ jsxDEV("div", { className: "pt-4 mt-2 flex gap-2", children: [
        /* @__PURE__ */ jsxDEV(
          Textarea,
          {
            value: input,
            onChange: (e) => setInput(e.target.value),
            onKeyDown: (e) => e.key === "Enter" && !e.shiftKey && handleSend(),
            placeholder: t("ai.placeholder"),
            disabled: isLoading,
            className: "flex-1"
          },
          void 0,
          false,
          {
            fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
            lineNumber: 230,
            columnNumber: 11
          },
          this
        ),
        /* @__PURE__ */ jsxDEV(Button, { onClick: handleSend, disabled: isLoading, children: /* @__PURE__ */ jsxDEV(Send, { className: "h-4 w-4" }, void 0, false, {
          fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
          lineNumber: 239,
          columnNumber: 13
        }, this) }, void 0, false, {
          fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
          lineNumber: 238,
          columnNumber: 11
        }, this)
      ] }, void 0, true, {
        fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
        lineNumber: 229,
        columnNumber: 9
      }, this)
    ] }, void 0, true, {
      fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
      lineNumber: 180,
      columnNumber: 7
    }, this)
  ] }, void 0, true, {
    fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
    lineNumber: 125,
    columnNumber: 5
  }, this);
}
_s(AiAgent, "VCTXRZPUfCd3F24yX36rYSdwhJs=", false, function() {
  return [useTranslation];
});
_c = AiAgent;
var _c;
$RefreshReg$(_c, "AiAgent");
import * as RefreshRuntime from "/@react-refresh";
const inWebWorker = typeof WorkerGlobalScope !== "undefined" && self instanceof WorkerGlobalScope;
if (import.meta.hot && !inWebWorker) {
  if (!window.$RefreshReg$) {
    throw new Error(
      "@vitejs/plugin-react can't detect preamble. Something is wrong."
    );
  }
  RefreshRuntime.__hmr_import(import.meta.url).then((currentExports) => {
    RefreshRuntime.registerExportsForReactRefresh("D:/桌面端应用plus/app/src/pages/AiAgent.tsx", currentExports);
    import.meta.hot.accept((nextExports) => {
      if (!nextExports) return;
      const invalidateMessage = RefreshRuntime.validateRefreshBoundaryAndEnqueueUpdate("D:/桌面端应用plus/app/src/pages/AiAgent.tsx", currentExports, nextExports);
      if (invalidateMessage) import.meta.hot.invalidate(invalidateMessage);
    });
  });
}
function $RefreshReg$(type, id) {
  return RefreshRuntime.register(type, "D:/桌面端应用plus/app/src/pages/AiAgent.tsx " + id);
}
function $RefreshSig$() {
  return RefreshRuntime.createSignatureFunctionForTransform();
}

//# sourceMappingURL=data:application/json;base64,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ZUVmZmVjdCIsInVzZVRyYW5zbGF0aW9uIiwidG9hc3QiLCJCdXR0b24iLCJJbnB1dCIsIlNjcm9sbEFyZWEiLCJDYXJkIiwiU2VuZCIsIkJvdCIsIlVzZXIiLCJTZXR0aW5nczIiLCJheGlvcyIsImRiIiwiRGlhbG9nIiwiRGlhbG9nQ29udGVudCIsIkRpYWxvZ0hlYWRlciIsIkRpYWxvZ1RpdGxlIiwiRGlhbG9nVHJpZ2dlciIsIkRpYWxvZ0Rlc2NyaXB0aW9uIiwiTGFiZWwiLCJUZXh0YXJlYSIsIkFpQWdlbnQiLCJfcyIsInQiLCJtZXNzYWdlcyIsInNldE1lc3NhZ2VzIiwiaW5wdXQiLCJzZXRJbnB1dCIsImlzTG9hZGluZyIsInNldElzTG9hZGluZyIsInNjcm9sbFJlZiIsInN5c3RlbVByb21wdCIsInNldFN5c3RlbVByb21wdCIsImFwaUtleSIsInNldEFwaUtleSIsIm1vZGVsIiwic2V0TW9kZWwiLCJsb2FkU2V0dGluZ3MiLCJzZXR0aW5ncyIsImdldFNldHRpbmdzIiwic2F2ZUNvbmZpZyIsInRyaW0iLCJlcnJvciIsInNhdmVTZXR0aW5ncyIsInN1Y2Nlc3MiLCJjb25zb2xlIiwiY3VycmVudCIsInNjcm9sbEludG9WaWV3IiwiYmVoYXZpb3IiLCJoYW5kbGVTZW5kIiwidXNlck1zZyIsInJvbGUiLCJjb250ZW50IiwicHJldiIsImNvbnZlcnNhdGlvbiIsInJlc3BvbnNlIiwicG9zdCIsInN0cmVhbSIsImhlYWRlcnMiLCJhaU1zZyIsImRhdGEiLCJjaG9pY2VzIiwibWVzc2FnZSIsImVycm9yTXNnIiwiZSIsInRhcmdldCIsInZhbHVlIiwibGVuZ3RoIiwibWFwIiwibXNnIiwiaSIsImtleSIsInNoaWZ0S2V5IiwiX2MiLCIkUmVmcmVzaFJlZyQiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZXMiOlsiQWlBZ2VudC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdXNlU3RhdGUsIHVzZVJlZiwgdXNlRWZmZWN0IH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyB1c2VUcmFuc2xhdGlvbiB9IGZyb20gXCJyZWFjdC1pMThuZXh0XCI7XG5pbXBvcnQgeyB0b2FzdCB9IGZyb20gXCJzb25uZXJcIjtcbmltcG9ydCB7IEJ1dHRvbiB9IGZyb20gXCJAL2NvbXBvbmVudHMvdWkvYnV0dG9uXCI7XG5pbXBvcnQgeyBJbnB1dCB9IGZyb20gXCJAL2NvbXBvbmVudHMvdWkvaW5wdXRcIjtcbmltcG9ydCB7IFNjcm9sbEFyZWEgfSBmcm9tIFwiQC9jb21wb25lbnRzL3VpL3Njcm9sbC1hcmVhXCI7XG5pbXBvcnQgeyBDYXJkIH0gZnJvbSBcIkAvY29tcG9uZW50cy91aS9jYXJkXCI7XG5pbXBvcnQgeyBTZW5kLCBCb3QsIFVzZXIsIFNldHRpbmdzMiB9IGZyb20gXCJsdWNpZGUtcmVhY3RcIjtcbmltcG9ydCBheGlvcyBmcm9tIFwiYXhpb3NcIjtcbmltcG9ydCB7IGRiIH0gZnJvbSBcIkAvbGliL2RiXCI7XG5pbXBvcnQge1xuICBEaWFsb2csXG4gIERpYWxvZ0NvbnRlbnQsXG4gIERpYWxvZ0hlYWRlcixcbiAgRGlhbG9nVGl0bGUsXG4gIERpYWxvZ1RyaWdnZXIsXG4gIERpYWxvZ0Rlc2NyaXB0aW9uLFxufSBmcm9tIFwiQC9jb21wb25lbnRzL3VpL2RpYWxvZ1wiO1xuaW1wb3J0IHsgTGFiZWwgfSBmcm9tIFwiQC9jb21wb25lbnRzL3VpL2xhYmVsXCI7XG5pbXBvcnQgeyBUZXh0YXJlYSB9IGZyb20gXCJAL2NvbXBvbmVudHMvdWkvdGV4dGFyZWFcIjtcblxuaW50ZXJmYWNlIE1lc3NhZ2Uge1xuICByb2xlOiBcInVzZXJcIiB8IFwiYXNzaXN0YW50XCIgfCBcInN5c3RlbVwiO1xuICBjb250ZW50OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIEFpQWdlbnQoKSB7XG4gIGNvbnN0IHsgdCB9ID0gdXNlVHJhbnNsYXRpb24oKTtcbiAgY29uc3QgW21lc3NhZ2VzLCBzZXRNZXNzYWdlc10gPSB1c2VTdGF0ZTxNZXNzYWdlW10+KFtdKTtcbiAgY29uc3QgW2lucHV0LCBzZXRJbnB1dF0gPSB1c2VTdGF0ZShcIlwiKTtcbiAgY29uc3QgW2lzTG9hZGluZywgc2V0SXNMb2FkaW5nXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3Qgc2Nyb2xsUmVmID0gdXNlUmVmPEhUTUxEaXZFbGVtZW50PihudWxsKTtcbiAgXG4gIC8vIE1vZGVsIENvbmZpZ1xuICBjb25zdCBbc3lzdGVtUHJvbXB0LCBzZXRTeXN0ZW1Qcm9tcHRdID0gdXNlU3RhdGUoXCLkvaDmmK/kuIDkuKrkuZDkuo7liqnkurrnmoRBSeWKqeaJi+OAglwiKTtcbiAgY29uc3QgW2FwaUtleSwgc2V0QXBpS2V5XSA9IHVzZVN0YXRlKFwiMTJiM2NmNTFiYTA2NGE0NmI2OGVjYzZiYmQ1YjMxZWMua3dhOXlQb1VJeER4SjE2SlwiKTtcbiAgY29uc3QgW21vZGVsLCBzZXRNb2RlbF0gPSB1c2VTdGF0ZShcImdsbS00LWZsYXNoXCIpOyBcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIC8vIExvYWQgc2V0dGluZ3MgZnJvbSBEQlxuICAgIGNvbnN0IGxvYWRTZXR0aW5ncyA9IGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHNldHRpbmdzID0gYXdhaXQgZGIuZ2V0U2V0dGluZ3MoKTtcbiAgICAgIGlmIChzZXR0aW5ncy5hcGlLZXkpIHNldEFwaUtleShzZXR0aW5ncy5hcGlLZXkpO1xuICAgICAgaWYgKHNldHRpbmdzLm1vZGVsKSBzZXRNb2RlbChzZXR0aW5ncy5tb2RlbCk7XG4gICAgICBpZiAoc2V0dGluZ3Muc3lzdGVtUHJvbXB0KSBzZXRTeXN0ZW1Qcm9tcHQoc2V0dGluZ3Muc3lzdGVtUHJvbXB0KTtcbiAgICB9O1xuICAgIGxvYWRTZXR0aW5ncygpO1xuICB9LCBbXSk7XG5cbiAgY29uc3Qgc2F2ZUNvbmZpZyA9IGFzeW5jICgpID0+IHtcbiAgICBpZiAoIWFwaUtleS50cmltKCkpIHtcbiAgICAgIHRvYXN0LmVycm9yKFwiQVBJIEtleSBjYW5ub3QgYmUgZW1wdHkhXCIpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgYXdhaXQgZGIuc2F2ZVNldHRpbmdzKHsgYXBpS2V5LCBtb2RlbCwgc3lzdGVtUHJvbXB0IH0pO1xuICAgICAgdG9hc3Quc3VjY2VzcyhcIkNvbmZpZ3VyYXRpb24gc2F2ZWQgc3VjY2Vzc2Z1bGx5IVwiKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIlNhdmUgY29uZmlnIGVycm9yOlwiLCBlcnJvcik7XG4gICAgICB0b2FzdC5lcnJvcihcIkZhaWxlZCB0byBzYXZlIGNvbmZpZ3VyYXRpb24uXCIpO1xuICAgIH1cbiAgfTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChzY3JvbGxSZWYuY3VycmVudCkge1xuICAgICAgc2Nyb2xsUmVmLmN1cnJlbnQuc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogXCJzbW9vdGhcIiB9KTtcbiAgICB9XG4gIH0sIFttZXNzYWdlc10pO1xuXG4gIGNvbnN0IGhhbmRsZVNlbmQgPSBhc3luYyAoKSA9PiB7XG4gICAgaWYgKCFpbnB1dC50cmltKCkpIHJldHVybjtcbiAgICBpZiAoIWFwaUtleSkge1xuICAgICAgdG9hc3QuZXJyb3IoXCJQbGVhc2Ugc2V0IEFQSSBLZXkgZmlyc3QhXCIpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHVzZXJNc2c6IE1lc3NhZ2UgPSB7IHJvbGU6IFwidXNlclwiLCBjb250ZW50OiBpbnB1dCB9O1xuICAgIHNldE1lc3NhZ2VzKChwcmV2KSA9PiBbLi4ucHJldiwgdXNlck1zZ10pO1xuICAgIHNldElucHV0KFwiXCIpO1xuICAgIHNldElzTG9hZGluZyh0cnVlKTtcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBjb252ZXJzYXRpb24gPSBbXG4gICAgICAgIHsgcm9sZTogXCJzeXN0ZW1cIiwgY29udGVudDogc3lzdGVtUHJvbXB0IH0sXG4gICAgICAgIC4uLm1lc3NhZ2VzLFxuICAgICAgICB1c2VyTXNnXG4gICAgICBdO1xuXG4gICAgICAvLyBaaGlwdSBBSSBFbmRwb2ludFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBheGlvcy5wb3N0KFxuICAgICAgICBcImh0dHBzOi8vb3Blbi5iaWdtb2RlbC5jbi9hcGkvcGFhcy92NC9jaGF0L2NvbXBsZXRpb25zXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtb2RlbDogbW9kZWwsXG4gICAgICAgICAgbWVzc2FnZXM6IGNvbnZlcnNhdGlvbixcbiAgICAgICAgICBzdHJlYW06IGZhbHNlXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBcIkF1dGhvcml6YXRpb25cIjogYEJlYXJlciAke2FwaUtleX1gLFxuICAgICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IGFpTXNnOiBNZXNzYWdlID0ge1xuICAgICAgICByb2xlOiBcImFzc2lzdGFudFwiLFxuICAgICAgICBjb250ZW50OiByZXNwb25zZS5kYXRhLmNob2ljZXNbMF0ubWVzc2FnZS5jb250ZW50XG4gICAgICB9O1xuICAgICAgc2V0TWVzc2FnZXMoKHByZXYpID0+IFsuLi5wcmV2LCBhaU1zZ10pO1xuXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgY29uc29sZS5lcnJvcihcIkFJIEVycm9yOlwiLCBlcnJvcik7XG4gICAgICB0b2FzdC5lcnJvcihcIkFJIFJlcXVlc3QgRmFpbGVkXCIpO1xuICAgICAgY29uc3QgZXJyb3JNc2c6IE1lc3NhZ2UgPSB7XG4gICAgICAgIHJvbGU6IFwiYXNzaXN0YW50XCIsXG4gICAgICAgIGNvbnRlbnQ6IGBFcnJvcjogJHtlcnJvci5yZXNwb25zZT8uZGF0YT8uZXJyb3I/Lm1lc3NhZ2UgfHwgZXJyb3IubWVzc2FnZX1gXG4gICAgICB9O1xuICAgICAgc2V0TWVzc2FnZXMoKHByZXYpID0+IFsuLi5wcmV2LCBlcnJvck1zZ10pO1xuICAgIH0gZmluYWxseSB7XG4gICAgICBzZXRJc0xvYWRpbmcoZmFsc2UpO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4gKFxuICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBmbGV4LWNvbCBoLWZ1bGwgc3BhY2UteS00XCI+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktYmV0d2VlbiBib3JkZXItYiBwYi00XCI+XG4gICAgICAgIDxoMiBjbGFzc05hbWU9XCJ0ZXh0LTJ4bCBmb250LWJvbGQgZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTJcIj5cbiAgICAgICAgICA8Qm90IGNsYXNzTmFtZT1cImgtNiB3LTZcIiAvPiB7dChcIm5hdi5haVwiKX1cbiAgICAgICAgPC9oMj5cbiAgICAgICAgXG4gICAgICAgIDxEaWFsb2c+XG4gICAgICAgICAgPERpYWxvZ1RyaWdnZXIgYXNDaGlsZD5cbiAgICAgICAgICAgIDxCdXR0b24gdmFyaWFudD1cIm91dGxpbmVcIiBzaXplPVwic21cIj5cbiAgICAgICAgICAgICAgPFNldHRpbmdzMiBjbGFzc05hbWU9XCJoLTQgdy00IG1yLTJcIiAvPiBBZ2VudCBTZXR0aW5nc1xuICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgPC9EaWFsb2dUcmlnZ2VyPlxuICAgICAgICAgIDxEaWFsb2dDb250ZW50PlxuICAgICAgICAgICAgPERpYWxvZ0hlYWRlcj5cbiAgICAgICAgICAgICAgPERpYWxvZ1RpdGxlPkFnZW50IENvbmZpZ3VyYXRpb24gKFpoaXB1IEFJKTwvRGlhbG9nVGl0bGU+XG4gICAgICAgICAgICAgIDxEaWFsb2dEZXNjcmlwdGlvbj5cbiAgICAgICAgICAgICAgICBDb25maWd1cmUgeW91ciBBSSBtb2RlbCBzZXR0aW5ncyBhbmQgQVBJIGtleSBoZXJlLlxuICAgICAgICAgICAgICA8L0RpYWxvZ0Rlc2NyaXB0aW9uPlxuICAgICAgICAgICAgPC9EaWFsb2dIZWFkZXI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNwYWNlLXktNCBweS00XCI+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZCBnYXAtMlwiPlxuICAgICAgICAgICAgICAgIDxMYWJlbD5TeXN0ZW0gUHJvbXB0IChQZXJzb25hKTwvTGFiZWw+XG4gICAgICAgICAgICAgICAgPFRleHRhcmVhIFxuICAgICAgICAgICAgICAgICAgdmFsdWU9e3N5c3RlbVByb21wdH1cbiAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXsoZTogYW55KSA9PiBzZXRTeXN0ZW1Qcm9tcHQoZS50YXJnZXQudmFsdWUpfVxuICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJEZWZpbmUgaG93IHRoZSBhZ2VudCBiZWhhdmVzLi4uXCJcbiAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImgtMjRcIlxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQgZ2FwLTJcIj5cbiAgICAgICAgICAgICAgICA8TGFiZWw+QVBJIEtleSAoR0xNKTwvTGFiZWw+XG4gICAgICAgICAgICAgICAgPElucHV0IFxuICAgICAgICAgICAgICAgICAgdmFsdWU9e2FwaUtleX1cbiAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXsoZTogYW55KSA9PiBzZXRBcGlLZXkoZS50YXJnZXQudmFsdWUpfVxuICAgICAgICAgICAgICAgICAgdHlwZT1cInBhc3N3b3JkXCJcbiAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiRW50ZXIgeW91ciBaaGlwdSBBUEkgS2V5XCJcbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQteHMgdGV4dC1tdXRlZC1mb3JlZ3JvdW5kXCI+XG4gICAgICAgICAgICAgICAgICBHZXQga2V5IGZyb206IDxhIGhyZWY9XCJodHRwczovL29wZW4uYmlnbW9kZWwuY24vXCIgdGFyZ2V0PVwiX2JsYW5rXCIgY2xhc3NOYW1lPVwidW5kZXJsaW5lXCI+b3Blbi5iaWdtb2RlbC5jbjwvYT5cbiAgICAgICAgICAgICAgICA8L3A+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQgZ2FwLTJcIj5cbiAgICAgICAgICAgICAgICA8TGFiZWw+TW9kZWwgTmFtZTwvTGFiZWw+XG4gICAgICAgICAgICAgICAgPElucHV0IFxuICAgICAgICAgICAgICAgICAgdmFsdWU9e21vZGVsfVxuICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9eyhlOiBhbnkpID0+IHNldE1vZGVsKGUudGFyZ2V0LnZhbHVlKX1cbiAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiZS5nLiBnbG0tNC1mbGFzaFwiXG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDxCdXR0b24gb25DbGljaz17c2F2ZUNvbmZpZ30gY2xhc3NOYW1lPVwidy1mdWxsXCI+U2F2ZSBDb25maWd1cmF0aW9uPC9CdXR0b24+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L0RpYWxvZ0NvbnRlbnQ+XG4gICAgICAgIDwvRGlhbG9nPlxuICAgICAgPC9kaXY+XG5cbiAgICAgIDxDYXJkIGNsYXNzTmFtZT1cImZsZXgtMSBwLTQgb3ZlcmZsb3ctaGlkZGVuIGZsZXggZmxleC1jb2wgYmctbXV0ZWQvMzBcIj5cbiAgICAgICAgPFNjcm9sbEFyZWEgY2xhc3NOYW1lPVwiZmxleC0xIHByLTRcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNwYWNlLXktNFwiPlxuICAgICAgICAgICAge21lc3NhZ2VzLmxlbmd0aCA9PT0gMCAmJiAoXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC1jZW50ZXIgdGV4dC1tdXRlZC1mb3JlZ3JvdW5kIG10LTIwXCI+XG4gICAgICAgICAgICAgICAgPEJvdCBjbGFzc05hbWU9XCJoLTEyIHctMTIgbXgtYXV0byBtYi00IG9wYWNpdHktNTBcIiAvPlxuICAgICAgICAgICAgICAgIDxwPlN0YXJ0IGEgY29udmVyc2F0aW9uIHdpdGggeW91ciBBSSBBZ2VudC48L3A+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIHttZXNzYWdlcy5tYXAoKG1zZywgaSkgPT4gKFxuICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAga2V5PXtpfVxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17YGZsZXggJHtcbiAgICAgICAgICAgICAgICAgIG1zZy5yb2xlID09PSBcInVzZXJcIiA/IFwianVzdGlmeS1lbmRcIiA6IFwianVzdGlmeS1zdGFydFwiXG4gICAgICAgICAgICAgICAgfWB9XG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2BmbGV4IGdhcC0zIG1heC13LVs4MCVdICR7XG4gICAgICAgICAgICAgICAgICAgIG1zZy5yb2xlID09PSBcInVzZXJcIiA/IFwiZmxleC1yb3ctcmV2ZXJzZVwiIDogXCJmbGV4LXJvd1wiXG4gICAgICAgICAgICAgICAgICB9YH1cbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17YGgtOCB3LTggcm91bmRlZC1mdWxsIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIHNocmluay0wICR7XG4gICAgICAgICAgICAgICAgICAgIG1zZy5yb2xlID09PSBcInVzZXJcIiA/IFwiYmctcHJpbWFyeSB0ZXh0LXByaW1hcnktZm9yZWdyb3VuZFwiIDogXCJiZy1zZWNvbmRhcnlcIlxuICAgICAgICAgICAgICAgICAgfWB9PlxuICAgICAgICAgICAgICAgICAgICB7bXNnLnJvbGUgPT09IFwidXNlclwiID8gPFVzZXIgY2xhc3NOYW1lPVwiaC01IHctNVwiIC8+IDogPEJvdCBjbGFzc05hbWU9XCJoLTUgdy01XCIgLz59XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtgcC0zIHJvdW5kZWQtbGcgdGV4dC1zbSB3aGl0ZXNwYWNlLXByZS13cmFwICR7XG4gICAgICAgICAgICAgICAgICAgICAgbXNnLnJvbGUgPT09IFwidXNlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICA/IFwiYmctcHJpbWFyeSB0ZXh0LXByaW1hcnktZm9yZWdyb3VuZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICA6IFwiYmctY2FyZCBib3JkZXIgc2hhZG93LXNtXCJcbiAgICAgICAgICAgICAgICAgICAgfWB9XG4gICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIHttc2cuY29udGVudH1cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICkpfVxuICAgICAgICAgICAge2lzTG9hZGluZyAmJiAoXG4gICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgganVzdGlmeS1zdGFydFwiPlxuICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJnLWNhcmQgYm9yZGVyIHAtMyByb3VuZGVkLWxnIHRleHQtc20gc2hhZG93LXNtXCI+XG4gICAgICAgICAgICAgICAgICAgVGhpbmtpbmcuLi5cbiAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICl9XG4gICAgICAgICAgICA8ZGl2IHJlZj17c2Nyb2xsUmVmfSAvPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L1Njcm9sbEFyZWE+XG4gICAgICAgIFxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInB0LTQgbXQtMiBmbGV4IGdhcC0yXCI+XG4gICAgICAgICAgPFRleHRhcmVhIFxuICAgICAgICAgICAgdmFsdWU9e2lucHV0fVxuICAgICAgICAgICAgb25DaGFuZ2U9eyhlOiBhbnkpID0+IHNldElucHV0KGUudGFyZ2V0LnZhbHVlKX1cbiAgICAgICAgICAgIG9uS2V5RG93bj17KGU6IGFueSkgPT4gZS5rZXkgPT09IFwiRW50ZXJcIiAmJiAhZS5zaGlmdEtleSAmJiBoYW5kbGVTZW5kKCl9XG4gICAgICAgICAgICBwbGFjZWhvbGRlcj17dChcImFpLnBsYWNlaG9sZGVyXCIpfVxuICAgICAgICAgICAgZGlzYWJsZWQ9e2lzTG9hZGluZ31cbiAgICAgICAgICAgIGNsYXNzTmFtZT1cImZsZXgtMVwiXG4gICAgICAgICAgLz5cbiAgICAgICAgICA8QnV0dG9uIG9uQ2xpY2s9e2hhbmRsZVNlbmR9IGRpc2FibGVkPXtpc0xvYWRpbmd9PlxuICAgICAgICAgICAgPFNlbmQgY2xhc3NOYW1lPVwiaC00IHctNFwiIC8+XG4gICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9DYXJkPlxuICAgIDwvZGl2PlxuICApO1xufSJdLCJmaWxlIjoiRDov5qGM6Z2i56uv5bqU55SocGx1cy9hcHAvc3JjL3BhZ2VzL0FpQWdlbnQudHN4In0=