import { createHotContext as __vite__createHotContext } from "/@vite/client";import.meta.hot = __vite__createHotContext("/src/pages/AiAgent.tsx");import __vite__cjsImport0_react_jsxDevRuntime from "/node_modules/.vite/deps/react_jsx-dev-runtime.js?v=768075cb"; const jsxDEV = __vite__cjsImport0_react_jsxDevRuntime["jsxDEV"];
var _s = $RefreshSig$();
import __vite__cjsImport1_react from "/node_modules/.vite/deps/react.js?v=768075cb"; const useState = __vite__cjsImport1_react["useState"]; const useRef = __vite__cjsImport1_react["useRef"]; const useEffect = __vite__cjsImport1_react["useEffect"];
import { useTranslation } from "/node_modules/.vite/deps/react-i18next.js?v=768075cb";
import { Button } from "/src/components/ui/button.tsx";
import { Input } from "/src/components/ui/input.tsx";
import { ScrollArea } from "/src/components/ui/scroll-area.tsx";
import { Card } from "/src/components/ui/card.tsx";
import { Send, Bot, User, Settings2 } from "/node_modules/.vite/deps/lucide-react.js?v=768075cb";
import axios from "/node_modules/.vite/deps/axios.js?v=768075cb";
import { db } from "/src/lib/db.ts";
import {
  Dialog,
  DialogContent,
  DialogHeader,
  DialogTitle,
  DialogTrigger
} from "/src/components/ui/dialog.tsx";
import { Label } from "/src/components/ui/label.tsx";
import { Textarea } from "/src/components/ui/textarea.tsx";
export default function AiAgent() {
  _s();
  const { t } = useTranslation();
  const [messages, setMessages] = useState([]);
  const [input, setInput] = useState("");
  const [isLoading, setIsLoading] = useState(false);
  const scrollRef = useRef(null);
  const [systemPrompt, setSystemPrompt] = useState("你是一个乐于助人的AI助手。");
  const [apiKey, setApiKey] = useState("12b3cf51ba064a46b68ecc6bbd5b31ec.kwa9yPoUIxDxJ16J");
  const [model, setModel] = useState("glm-4-flash");
  useEffect(() => {
    const loadSettings = async () => {
      const settings = await db.getSettings();
      if (settings.apiKey) setApiKey(settings.apiKey);
      if (settings.model) setModel(settings.model);
      if (settings.systemPrompt) setSystemPrompt(settings.systemPrompt);
    };
    loadSettings();
  }, []);
  const saveConfig = async () => {
    await db.saveSettings({ apiKey, model, systemPrompt });
    toast.success(t("common.saved"));
  };
  useEffect(() => {
    if (scrollRef.current) {
      scrollRef.current.scrollIntoView({ behavior: "smooth" });
    }
  }, [messages]);
  const handleSend = async () => {
    if (!input.trim()) return;
    if (!apiKey) {
      toast.error("Please set API Key first!");
      return;
    }
    const userMsg = { role: "user", content: input };
    setMessages((prev) => [...prev, userMsg]);
    setInput("");
    setIsLoading(true);
    try {
      const conversation = [
        { role: "system", content: systemPrompt },
        ...messages,
        userMsg
      ];
      const response = await axios.post(
        "https://open.bigmodel.cn/api/paas/v4/chat/completions",
        {
          model,
          messages: conversation,
          stream: false
        },
        {
          headers: {
            "Authorization": `Bearer ${apiKey}`,
            "Content-Type": "application/json"
          }
        }
      );
      const aiMsg = {
        role: "assistant",
        content: response.data.choices[0].message.content
      };
      setMessages((prev) => [...prev, aiMsg]);
    } catch (error) {
      console.error("AI Error:", error);
      const errorMsg = {
        role: "assistant",
        content: `Error: ${error.response?.data?.error?.message || error.message}`
      };
      setMessages((prev) => [...prev, errorMsg]);
    } finally {
      setIsLoading(false);
    }
  };
  return /* @__PURE__ */ jsxDEV("div", { className: "flex flex-col h-full space-y-4", children: [
    /* @__PURE__ */ jsxDEV("div", { className: "flex items-center justify-between border-b pb-4", children: [
      /* @__PURE__ */ jsxDEV("h2", { className: "text-2xl font-bold flex items-center gap-2", children: [
        /* @__PURE__ */ jsxDEV(Bot, { className: "h-6 w-6" }, void 0, false, {
          fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
          lineNumber: 116,
          columnNumber: 11
        }, this),
        " ",
        t("nav.ai")
      ] }, void 0, true, {
        fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
        lineNumber: 115,
        columnNumber: 9
      }, this),
      /* @__PURE__ */ jsxDEV(Dialog, { children: [
        /* @__PURE__ */ jsxDEV(DialogTrigger, { asChild: true, children: /* @__PURE__ */ jsxDEV(Button, { variant: "outline", size: "sm", children: [
          /* @__PURE__ */ jsxDEV(Settings2, { className: "h-4 w-4 mr-2" }, void 0, false, {
            fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
            lineNumber: 122,
            columnNumber: 15
          }, this),
          " Agent Settings"
        ] }, void 0, true, {
          fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
          lineNumber: 121,
          columnNumber: 13
        }, this) }, void 0, false, {
          fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
          lineNumber: 120,
          columnNumber: 11
        }, this),
        /* @__PURE__ */ jsxDEV(DialogContent, { children: [
          /* @__PURE__ */ jsxDEV(DialogHeader, { children: /* @__PURE__ */ jsxDEV(DialogTitle, { children: "Agent Configuration (Zhipu AI)" }, void 0, false, {
            fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
            lineNumber: 127,
            columnNumber: 15
          }, this) }, void 0, false, {
            fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
            lineNumber: 126,
            columnNumber: 13
          }, this),
          /* @__PURE__ */ jsxDEV("div", { className: "space-y-4 py-4", children: [
            /* @__PURE__ */ jsxDEV("div", { className: "grid gap-2", children: [
              /* @__PURE__ */ jsxDEV(Label, { children: "System Prompt (Persona)" }, void 0, false, {
                fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
                lineNumber: 131,
                columnNumber: 17
              }, this),
              /* @__PURE__ */ jsxDEV(
                Textarea,
                {
                  value: systemPrompt,
                  onChange: (e) => setSystemPrompt(e.target.value),
                  placeholder: "Define how the agent behaves...",
                  className: "h-24"
                },
                void 0,
                false,
                {
                  fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
                  lineNumber: 132,
                  columnNumber: 17
                },
                this
              )
            ] }, void 0, true, {
              fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
              lineNumber: 130,
              columnNumber: 15
            }, this),
            /* @__PURE__ */ jsxDEV("div", { className: "grid gap-2", children: [
              /* @__PURE__ */ jsxDEV(Label, { children: "API Key (GLM)" }, void 0, false, {
                fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
                lineNumber: 140,
                columnNumber: 17
              }, this),
              /* @__PURE__ */ jsxDEV(
                Input,
                {
                  value: apiKey,
                  onChange: (e) => setApiKey(e.target.value),
                  type: "password",
                  placeholder: "Enter your Zhipu API Key"
                },
                void 0,
                false,
                {
                  fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
                  lineNumber: 141,
                  columnNumber: 17
                },
                this
              ),
              /* @__PURE__ */ jsxDEV("p", { className: "text-xs text-muted-foreground", children: [
                "Get key from: ",
                /* @__PURE__ */ jsxDEV("a", { href: "https://open.bigmodel.cn/", target: "_blank", className: "underline", children: "open.bigmodel.cn" }, void 0, false, {
                  fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
                  lineNumber: 148,
                  columnNumber: 33
                }, this)
              ] }, void 0, true, {
                fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
                lineNumber: 147,
                columnNumber: 17
              }, this)
            ] }, void 0, true, {
              fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
              lineNumber: 139,
              columnNumber: 15
            }, this),
            /* @__PURE__ */ jsxDEV("div", { className: "grid gap-2", children: [
              /* @__PURE__ */ jsxDEV(Label, { children: "Model Name" }, void 0, false, {
                fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
                lineNumber: 152,
                columnNumber: 17
              }, this),
              /* @__PURE__ */ jsxDEV(
                Input,
                {
                  value: model,
                  onChange: (e) => setModel(e.target.value),
                  placeholder: "e.g. glm-4-flash"
                },
                void 0,
                false,
                {
                  fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
                  lineNumber: 153,
                  columnNumber: 17
                },
                this
              )
            ] }, void 0, true, {
              fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
              lineNumber: 151,
              columnNumber: 15
            }, this),
            /* @__PURE__ */ jsxDEV(Button, { onClick: saveConfig, className: "w-full", children: "Save Configuration" }, void 0, false, {
              fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
              lineNumber: 159,
              columnNumber: 15
            }, this)
          ] }, void 0, true, {
            fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
            lineNumber: 129,
            columnNumber: 13
          }, this)
        ] }, void 0, true, {
          fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
          lineNumber: 125,
          columnNumber: 11
        }, this)
      ] }, void 0, true, {
        fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
        lineNumber: 119,
        columnNumber: 9
      }, this)
    ] }, void 0, true, {
      fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
      lineNumber: 114,
      columnNumber: 7
    }, this),
    /* @__PURE__ */ jsxDEV(Card, { className: "flex-1 p-4 overflow-hidden flex flex-col bg-muted/30", children: [
      /* @__PURE__ */ jsxDEV(ScrollArea, { className: "flex-1 pr-4", children: /* @__PURE__ */ jsxDEV("div", { className: "space-y-4", children: [
        messages.length === 0 && /* @__PURE__ */ jsxDEV("div", { className: "text-center text-muted-foreground mt-20", children: [
          /* @__PURE__ */ jsxDEV(Bot, { className: "h-12 w-12 mx-auto mb-4 opacity-50" }, void 0, false, {
            fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
            lineNumber: 170,
            columnNumber: 17
          }, this),
          /* @__PURE__ */ jsxDEV("p", { children: "Start a conversation with your AI Agent." }, void 0, false, {
            fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
            lineNumber: 171,
            columnNumber: 17
          }, this)
        ] }, void 0, true, {
          fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
          lineNumber: 169,
          columnNumber: 13
        }, this),
        messages.map(
          (msg, i) => /* @__PURE__ */ jsxDEV(
            "div",
            {
              className: `flex ${msg.role === "user" ? "justify-end" : "justify-start"}`,
              children: /* @__PURE__ */ jsxDEV(
                "div",
                {
                  className: `flex gap-3 max-w-[80%] ${msg.role === "user" ? "flex-row-reverse" : "flex-row"}`,
                  children: [
                    /* @__PURE__ */ jsxDEV("div", { className: `h-8 w-8 rounded-full flex items-center justify-center shrink-0 ${msg.role === "user" ? "bg-primary text-primary-foreground" : "bg-secondary"}`, children: msg.role === "user" ? /* @__PURE__ */ jsxDEV(User, { className: "h-5 w-5" }, void 0, false, {
                      fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
                      lineNumber: 189,
                      columnNumber: 44
                    }, this) : /* @__PURE__ */ jsxDEV(Bot, { className: "h-5 w-5" }, void 0, false, {
                      fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
                      lineNumber: 189,
                      columnNumber: 75
                    }, this) }, void 0, false, {
                      fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
                      lineNumber: 186,
                      columnNumber: 19
                    }, this),
                    /* @__PURE__ */ jsxDEV(
                      "div",
                      {
                        className: `p-3 rounded-lg text-sm whitespace-pre-wrap ${msg.role === "user" ? "bg-primary text-primary-foreground" : "bg-card border shadow-sm"}`,
                        children: msg.content
                      },
                      void 0,
                      false,
                      {
                        fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
                        lineNumber: 191,
                        columnNumber: 19
                      },
                      this
                    )
                  ]
                },
                void 0,
                true,
                {
                  fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
                  lineNumber: 181,
                  columnNumber: 17
                },
                this
              )
            },
            i,
            false,
            {
              fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
              lineNumber: 175,
              columnNumber: 13
            },
            this
          )
        ),
        isLoading && /* @__PURE__ */ jsxDEV("div", { className: "flex justify-start", children: /* @__PURE__ */ jsxDEV("div", { className: "bg-card border p-3 rounded-lg text-sm shadow-sm", children: "Thinking..." }, void 0, false, {
          fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
          lineNumber: 205,
          columnNumber: 18
        }, this) }, void 0, false, {
          fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
          lineNumber: 204,
          columnNumber: 13
        }, this),
        /* @__PURE__ */ jsxDEV("div", { ref: scrollRef }, void 0, false, {
          fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
          lineNumber: 210,
          columnNumber: 13
        }, this)
      ] }, void 0, true, {
        fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
        lineNumber: 167,
        columnNumber: 11
      }, this) }, void 0, false, {
        fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
        lineNumber: 166,
        columnNumber: 9
      }, this),
      /* @__PURE__ */ jsxDEV("div", { className: "pt-4 mt-2 flex gap-2", children: [
        /* @__PURE__ */ jsxDEV(
          Textarea,
          {
            value: input,
            onChange: (e) => setInput(e.target.value),
            onKeyDown: (e) => e.key === "Enter" && !e.shiftKey && handleSend(),
            placeholder: t("ai.placeholder"),
            disabled: isLoading,
            className: "flex-1"
          },
          void 0,
          false,
          {
            fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
            lineNumber: 215,
            columnNumber: 11
          },
          this
        ),
        /* @__PURE__ */ jsxDEV(Button, { onClick: handleSend, disabled: isLoading, children: /* @__PURE__ */ jsxDEV(Send, { className: "h-4 w-4" }, void 0, false, {
          fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
          lineNumber: 224,
          columnNumber: 13
        }, this) }, void 0, false, {
          fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
          lineNumber: 223,
          columnNumber: 11
        }, this)
      ] }, void 0, true, {
        fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
        lineNumber: 214,
        columnNumber: 9
      }, this)
    ] }, void 0, true, {
      fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
      lineNumber: 165,
      columnNumber: 7
    }, this)
  ] }, void 0, true, {
    fileName: "D:/桌面端应用plus/app/src/pages/AiAgent.tsx",
    lineNumber: 113,
    columnNumber: 5
  }, this);
}
_s(AiAgent, "VCTXRZPUfCd3F24yX36rYSdwhJs=", false, function() {
  return [useTranslation];
});
_c = AiAgent;
var _c;
$RefreshReg$(_c, "AiAgent");
import * as RefreshRuntime from "/@react-refresh";
const inWebWorker = typeof WorkerGlobalScope !== "undefined" && self instanceof WorkerGlobalScope;
if (import.meta.hot && !inWebWorker) {
  if (!window.$RefreshReg$) {
    throw new Error(
      "@vitejs/plugin-react can't detect preamble. Something is wrong."
    );
  }
  RefreshRuntime.__hmr_import(import.meta.url).then((currentExports) => {
    RefreshRuntime.registerExportsForReactRefresh("D:/桌面端应用plus/app/src/pages/AiAgent.tsx", currentExports);
    import.meta.hot.accept((nextExports) => {
      if (!nextExports) return;
      const invalidateMessage = RefreshRuntime.validateRefreshBoundaryAndEnqueueUpdate("D:/桌面端应用plus/app/src/pages/AiAgent.tsx", currentExports, nextExports);
      if (invalidateMessage) import.meta.hot.invalidate(invalidateMessage);
    });
  });
}
function $RefreshReg$(type, id) {
  return RefreshRuntime.register(type, "D:/桌面端应用plus/app/src/pages/AiAgent.tsx " + id);
}
function $RefreshSig$() {
  return RefreshRuntime.createSignatureFunctionForTransform();
}

//# sourceMappingURL=data:application/json;base64,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QUFBQSxZQUNQLFVBQVUsQ0FBQ3VDLE1BQVd0QyxTQUFTc0MsRUFBRUMsT0FBT0MsS0FBSztBQUFBLFlBQzdDLFdBQVcsQ0FBQ0YsTUFBV0EsRUFBRU8sUUFBUSxXQUFXLENBQUNQLEVBQUVRLFlBQVkxQixXQUFXO0FBQUEsWUFDdEUsYUFBYXhCLEVBQUUsZ0JBQWdCO0FBQUEsWUFDL0IsVUFBVUs7QUFBQUEsWUFDVixXQUFVO0FBQUE7QUFBQSxVQU5aO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxRQU1vQjtBQUFBLFFBRXBCLHVCQUFDLFVBQU8sU0FBU21CLFlBQVksVUFBVW5CLFdBQ3JDLGlDQUFDLFFBQUssV0FBVSxhQUFoQjtBQUFBO0FBQUE7QUFBQTtBQUFBLGVBQXlCLEtBRDNCO0FBQUE7QUFBQTtBQUFBO0FBQUEsZUFFQTtBQUFBLFdBWEY7QUFBQTtBQUFBO0FBQUE7QUFBQSxhQVlBO0FBQUEsU0E3REY7QUFBQTtBQUFBO0FBQUE7QUFBQSxXQThEQTtBQUFBLE9BbEhGO0FBQUE7QUFBQTtBQUFBO0FBQUEsU0FtSEE7QUFFSjtBQUFDTixHQTdNdUJELFNBQU87QUFBQSxVQUNmbEIsY0FBYztBQUFBO0FBQUF1RSxLQUROckQ7QUFBTyxJQUFBcUQ7QUFBQUMsYUFBQUQsSUFBQSIsIm5hbWVzIjpbInVzZVN0YXRlIiwidXNlUmVmIiwidXNlRWZmZWN0IiwidXNlVHJhbnNsYXRpb24iLCJCdXR0b24iLCJJbnB1dCIsIlNjcm9sbEFyZWEiLCJDYXJkIiwiU2VuZCIsIkJvdCIsIlVzZXIiLCJTZXR0aW5nczIiLCJheGlvcyIsImRiIiwiRGlhbG9nIiwiRGlhbG9nQ29udGVudCIsIkRpYWxvZ0hlYWRlciIsIkRpYWxvZ1RpdGxlIiwiRGlhbG9nVHJpZ2dlciIsIkxhYmVsIiwiVGV4dGFyZWEiLCJBaUFnZW50IiwiX3MiLCJ0IiwibWVzc2FnZXMiLCJzZXRNZXNzYWdlcyIsImlucHV0Iiwic2V0SW5wdXQiLCJpc0xvYWRpbmciLCJzZXRJc0xvYWRpbmciLCJzY3JvbGxSZWYiLCJzeXN0ZW1Qcm9tcHQiLCJzZXRTeXN0ZW1Qcm9tcHQiLCJhcGlLZXkiLCJzZXRBcGlLZXkiLCJtb2RlbCIsInNldE1vZGVsIiwibG9hZFNldHRpbmdzIiwic2V0dGluZ3MiLCJnZXRTZXR0aW5ncyIsInNhdmVDb25maWciLCJzYXZlU2V0dGluZ3MiLCJ0b2FzdCIsInN1Y2Nlc3MiLCJjdXJyZW50Iiwic2Nyb2xsSW50b1ZpZXciLCJiZWhhdmlvciIsImhhbmRsZVNlbmQiLCJ0cmltIiwiZXJyb3IiLCJ1c2VyTXNnIiwicm9sZSIsImNvbnRlbnQiLCJwcmV2IiwiY29udmVyc2F0aW9uIiwicmVzcG9uc2UiLCJwb3N0Iiwic3RyZWFtIiwiaGVhZGVycyIsImFpTXNnIiwiZGF0YSIsImNob2ljZXMiLCJtZXNzYWdlIiwiY29uc29sZSIsImVycm9yTXNnIiwiZSIsInRhcmdldCIsInZhbHVlIiwibGVuZ3RoIiwibWFwIiwibXNnIiwiaSIsImtleSIsInNoaWZ0S2V5IiwiX2MiLCIkUmVmcmVzaFJlZyQiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZXMiOlsiQWlBZ2VudC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdXNlU3RhdGUsIHVzZVJlZiwgdXNlRWZmZWN0IH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyB1c2VUcmFuc2xhdGlvbiB9IGZyb20gXCJyZWFjdC1pMThuZXh0XCI7XG5pbXBvcnQgeyBCdXR0b24gfSBmcm9tIFwiQC9jb21wb25lbnRzL3VpL2J1dHRvblwiO1xuaW1wb3J0IHsgSW5wdXQgfSBmcm9tIFwiQC9jb21wb25lbnRzL3VpL2lucHV0XCI7XG5pbXBvcnQgeyBTY3JvbGxBcmVhIH0gZnJvbSBcIkAvY29tcG9uZW50cy91aS9zY3JvbGwtYXJlYVwiO1xuaW1wb3J0IHsgQ2FyZCB9IGZyb20gXCJAL2NvbXBvbmVudHMvdWkvY2FyZFwiO1xuaW1wb3J0IHsgU2VuZCwgQm90LCBVc2VyLCBTZXR0aW5nczIgfSBmcm9tIFwibHVjaWRlLXJlYWN0XCI7XG5pbXBvcnQgYXhpb3MgZnJvbSBcImF4aW9zXCI7XG5pbXBvcnQgeyBkYiB9IGZyb20gXCJAL2xpYi9kYlwiO1xuaW1wb3J0IHtcbiAgRGlhbG9nLFxuICBEaWFsb2dDb250ZW50LFxuICBEaWFsb2dIZWFkZXIsXG4gIERpYWxvZ1RpdGxlLFxuICBEaWFsb2dUcmlnZ2VyLFxufSBmcm9tIFwiQC9jb21wb25lbnRzL3VpL2RpYWxvZ1wiO1xuaW1wb3J0IHsgTGFiZWwgfSBmcm9tIFwiQC9jb21wb25lbnRzL3VpL2xhYmVsXCI7XG5pbXBvcnQgeyBUZXh0YXJlYSB9IGZyb20gXCJAL2NvbXBvbmVudHMvdWkvdGV4dGFyZWFcIjtcblxuaW50ZXJmYWNlIE1lc3NhZ2Uge1xuICByb2xlOiBcInVzZXJcIiB8IFwiYXNzaXN0YW50XCIgfCBcInN5c3RlbVwiO1xuICBjb250ZW50OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIEFpQWdlbnQoKSB7XG4gIGNvbnN0IHsgdCB9ID0gdXNlVHJhbnNsYXRpb24oKTtcbiAgY29uc3QgW21lc3NhZ2VzLCBzZXRNZXNzYWdlc10gPSB1c2VTdGF0ZTxNZXNzYWdlW10+KFtdKTtcbiAgY29uc3QgW2lucHV0LCBzZXRJbnB1dF0gPSB1c2VTdGF0ZShcIlwiKTtcbiAgY29uc3QgW2lzTG9hZGluZywgc2V0SXNMb2FkaW5nXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3Qgc2Nyb2xsUmVmID0gdXNlUmVmPEhUTUxEaXZFbGVtZW50PihudWxsKTtcbiAgXG4gIC8vIE1vZGVsIENvbmZpZ1xuICBjb25zdCBbc3lzdGVtUHJvbXB0LCBzZXRTeXN0ZW1Qcm9tcHRdID0gdXNlU3RhdGUoXCLkvaDmmK/kuIDkuKrkuZDkuo7liqnkurrnmoRBSeWKqeaJi+OAglwiKTtcbiAgY29uc3QgW2FwaUtleSwgc2V0QXBpS2V5XSA9IHVzZVN0YXRlKFwiMTJiM2NmNTFiYTA2NGE0NmI2OGVjYzZiYmQ1YjMxZWMua3dhOXlQb1VJeER4SjE2SlwiKTtcbiAgY29uc3QgW21vZGVsLCBzZXRNb2RlbF0gPSB1c2VTdGF0ZShcImdsbS00LWZsYXNoXCIpOyBcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIC8vIExvYWQgc2V0dGluZ3MgZnJvbSBEQlxuICAgIGNvbnN0IGxvYWRTZXR0aW5ncyA9IGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHNldHRpbmdzID0gYXdhaXQgZGIuZ2V0U2V0dGluZ3MoKTtcbiAgICAgIGlmIChzZXR0aW5ncy5hcGlLZXkpIHNldEFwaUtleShzZXR0aW5ncy5hcGlLZXkpO1xuICAgICAgaWYgKHNldHRpbmdzLm1vZGVsKSBzZXRNb2RlbChzZXR0aW5ncy5tb2RlbCk7XG4gICAgICBpZiAoc2V0dGluZ3Muc3lzdGVtUHJvbXB0KSBzZXRTeXN0ZW1Qcm9tcHQoc2V0dGluZ3Muc3lzdGVtUHJvbXB0KTtcbiAgICB9O1xuICAgIGxvYWRTZXR0aW5ncygpO1xuICB9LCBbXSk7XG5cbiAgY29uc3Qgc2F2ZUNvbmZpZyA9IGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCBkYi5zYXZlU2V0dGluZ3MoeyBhcGlLZXksIG1vZGVsLCBzeXN0ZW1Qcm9tcHQgfSk7XG4gICAgdG9hc3Quc3VjY2Vzcyh0KFwiY29tbW9uLnNhdmVkXCIpKTtcbiAgfTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChzY3JvbGxSZWYuY3VycmVudCkge1xuICAgICAgc2Nyb2xsUmVmLmN1cnJlbnQuc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogXCJzbW9vdGhcIiB9KTtcbiAgICB9XG4gIH0sIFttZXNzYWdlc10pO1xuXG4gIGNvbnN0IGhhbmRsZVNlbmQgPSBhc3luYyAoKSA9PiB7XG4gICAgaWYgKCFpbnB1dC50cmltKCkpIHJldHVybjtcbiAgICBpZiAoIWFwaUtleSkge1xuICAgICAgdG9hc3QuZXJyb3IoXCJQbGVhc2Ugc2V0IEFQSSBLZXkgZmlyc3QhXCIpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHVzZXJNc2c6IE1lc3NhZ2UgPSB7IHJvbGU6IFwidXNlclwiLCBjb250ZW50OiBpbnB1dCB9O1xuICAgIHNldE1lc3NhZ2VzKChwcmV2KSA9PiBbLi4ucHJldiwgdXNlck1zZ10pO1xuICAgIHNldElucHV0KFwiXCIpO1xuICAgIHNldElzTG9hZGluZyh0cnVlKTtcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBjb252ZXJzYXRpb24gPSBbXG4gICAgICAgIHsgcm9sZTogXCJzeXN0ZW1cIiwgY29udGVudDogc3lzdGVtUHJvbXB0IH0sXG4gICAgICAgIC4uLm1lc3NhZ2VzLFxuICAgICAgICB1c2VyTXNnXG4gICAgICBdO1xuXG4gICAgICAvLyBaaGlwdSBBSSBFbmRwb2ludFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBheGlvcy5wb3N0KFxuICAgICAgICBcImh0dHBzOi8vb3Blbi5iaWdtb2RlbC5jbi9hcGkvcGFhcy92NC9jaGF0L2NvbXBsZXRpb25zXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtb2RlbDogbW9kZWwsXG4gICAgICAgICAgbWVzc2FnZXM6IGNvbnZlcnNhdGlvbixcbiAgICAgICAgICBzdHJlYW06IGZhbHNlXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBcIkF1dGhvcml6YXRpb25cIjogYEJlYXJlciAke2FwaUtleX1gLFxuICAgICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IGFpTXNnOiBNZXNzYWdlID0ge1xuICAgICAgICByb2xlOiBcImFzc2lzdGFudFwiLFxuICAgICAgICBjb250ZW50OiByZXNwb25zZS5kYXRhLmNob2ljZXNbMF0ubWVzc2FnZS5jb250ZW50XG4gICAgICB9O1xuICAgICAgc2V0TWVzc2FnZXMoKHByZXYpID0+IFsuLi5wcmV2LCBhaU1zZ10pO1xuXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgY29uc29sZS5lcnJvcihcIkFJIEVycm9yOlwiLCBlcnJvcik7XG4gICAgICBjb25zdCBlcnJvck1zZzogTWVzc2FnZSA9IHtcbiAgICAgICAgcm9sZTogXCJhc3Npc3RhbnRcIixcbiAgICAgICAgY29udGVudDogYEVycm9yOiAke2Vycm9yLnJlc3BvbnNlPy5kYXRhPy5lcnJvcj8ubWVzc2FnZSB8fCBlcnJvci5tZXNzYWdlfWBcbiAgICAgIH07XG4gICAgICBzZXRNZXNzYWdlcygocHJldikgPT4gWy4uLnByZXYsIGVycm9yTXNnXSk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHNldElzTG9hZGluZyhmYWxzZSk7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiAoXG4gICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGZsZXgtY29sIGgtZnVsbCBzcGFjZS15LTRcIj5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1iZXR3ZWVuIGJvcmRlci1iIHBiLTRcIj5cbiAgICAgICAgPGgyIGNsYXNzTmFtZT1cInRleHQtMnhsIGZvbnQtYm9sZCBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMlwiPlxuICAgICAgICAgIDxCb3QgY2xhc3NOYW1lPVwiaC02IHctNlwiIC8+IHt0KFwibmF2LmFpXCIpfVxuICAgICAgICA8L2gyPlxuICAgICAgICBcbiAgICAgICAgPERpYWxvZz5cbiAgICAgICAgICA8RGlhbG9nVHJpZ2dlciBhc0NoaWxkPlxuICAgICAgICAgICAgPEJ1dHRvbiB2YXJpYW50PVwib3V0bGluZVwiIHNpemU9XCJzbVwiPlxuICAgICAgICAgICAgICA8U2V0dGluZ3MyIGNsYXNzTmFtZT1cImgtNCB3LTQgbXItMlwiIC8+IEFnZW50IFNldHRpbmdzXG4gICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICA8L0RpYWxvZ1RyaWdnZXI+XG4gICAgICAgICAgPERpYWxvZ0NvbnRlbnQ+XG4gICAgICAgICAgICA8RGlhbG9nSGVhZGVyPlxuICAgICAgICAgICAgICA8RGlhbG9nVGl0bGU+QWdlbnQgQ29uZmlndXJhdGlvbiAoWmhpcHUgQUkpPC9EaWFsb2dUaXRsZT5cbiAgICAgICAgICAgIDwvRGlhbG9nSGVhZGVyPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzcGFjZS15LTQgcHktNFwiPlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQgZ2FwLTJcIj5cbiAgICAgICAgICAgICAgICA8TGFiZWw+U3lzdGVtIFByb21wdCAoUGVyc29uYSk8L0xhYmVsPlxuICAgICAgICAgICAgICAgIDxUZXh0YXJlYSBcbiAgICAgICAgICAgICAgICAgIHZhbHVlPXtzeXN0ZW1Qcm9tcHR9XG4gICAgICAgICAgICAgICAgICBvbkNoYW5nZT17KGU6IGFueSkgPT4gc2V0U3lzdGVtUHJvbXB0KGUudGFyZ2V0LnZhbHVlKX1cbiAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiRGVmaW5lIGhvdyB0aGUgYWdlbnQgYmVoYXZlcy4uLlwiXG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJoLTI0XCJcbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkIGdhcC0yXCI+XG4gICAgICAgICAgICAgICAgPExhYmVsPkFQSSBLZXkgKEdMTSk8L0xhYmVsPlxuICAgICAgICAgICAgICAgIDxJbnB1dCBcbiAgICAgICAgICAgICAgICAgIHZhbHVlPXthcGlLZXl9XG4gICAgICAgICAgICAgICAgICBvbkNoYW5nZT17KGU6IGFueSkgPT4gc2V0QXBpS2V5KGUudGFyZ2V0LnZhbHVlKX1cbiAgICAgICAgICAgICAgICAgIHR5cGU9XCJwYXNzd29yZFwiXG4gICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIkVudGVyIHlvdXIgWmhpcHUgQVBJIEtleVwiXG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXhzIHRleHQtbXV0ZWQtZm9yZWdyb3VuZFwiPlxuICAgICAgICAgICAgICAgICAgR2V0IGtleSBmcm9tOiA8YSBocmVmPVwiaHR0cHM6Ly9vcGVuLmJpZ21vZGVsLmNuL1wiIHRhcmdldD1cIl9ibGFua1wiIGNsYXNzTmFtZT1cInVuZGVybGluZVwiPm9wZW4uYmlnbW9kZWwuY248L2E+XG4gICAgICAgICAgICAgICAgPC9wPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkIGdhcC0yXCI+XG4gICAgICAgICAgICAgICAgPExhYmVsPk1vZGVsIE5hbWU8L0xhYmVsPlxuICAgICAgICAgICAgICAgIDxJbnB1dCBcbiAgICAgICAgICAgICAgICAgIHZhbHVlPXttb2RlbH1cbiAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXsoZTogYW55KSA9PiBzZXRNb2RlbChlLnRhcmdldC52YWx1ZSl9XG4gICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cImUuZy4gZ2xtLTQtZmxhc2hcIlxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8QnV0dG9uIG9uQ2xpY2s9e3NhdmVDb25maWd9IGNsYXNzTmFtZT1cInctZnVsbFwiPlNhdmUgQ29uZmlndXJhdGlvbjwvQnV0dG9uPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9EaWFsb2dDb250ZW50PlxuICAgICAgICA8L0RpYWxvZz5cbiAgICAgIDwvZGl2PlxuXG4gICAgICA8Q2FyZCBjbGFzc05hbWU9XCJmbGV4LTEgcC00IG92ZXJmbG93LWhpZGRlbiBmbGV4IGZsZXgtY29sIGJnLW11dGVkLzMwXCI+XG4gICAgICAgIDxTY3JvbGxBcmVhIGNsYXNzTmFtZT1cImZsZXgtMSBwci00XCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzcGFjZS15LTRcIj5cbiAgICAgICAgICAgIHttZXNzYWdlcy5sZW5ndGggPT09IDAgJiYgKFxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQtY2VudGVyIHRleHQtbXV0ZWQtZm9yZWdyb3VuZCBtdC0yMFwiPlxuICAgICAgICAgICAgICAgIDxCb3QgY2xhc3NOYW1lPVwiaC0xMiB3LTEyIG14LWF1dG8gbWItNCBvcGFjaXR5LTUwXCIgLz5cbiAgICAgICAgICAgICAgICA8cD5TdGFydCBhIGNvbnZlcnNhdGlvbiB3aXRoIHlvdXIgQUkgQWdlbnQuPC9wPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICl9XG4gICAgICAgICAgICB7bWVzc2FnZXMubWFwKChtc2csIGkpID0+IChcbiAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgIGtleT17aX1cbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2BmbGV4ICR7XG4gICAgICAgICAgICAgICAgICBtc2cucm9sZSA9PT0gXCJ1c2VyXCIgPyBcImp1c3RpZnktZW5kXCIgOiBcImp1c3RpZnktc3RhcnRcIlxuICAgICAgICAgICAgICAgIH1gfVxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtgZmxleCBnYXAtMyBtYXgtdy1bODAlXSAke1xuICAgICAgICAgICAgICAgICAgICBtc2cucm9sZSA9PT0gXCJ1c2VyXCIgPyBcImZsZXgtcm93LXJldmVyc2VcIiA6IFwiZmxleC1yb3dcIlxuICAgICAgICAgICAgICAgICAgfWB9XG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2BoLTggdy04IHJvdW5kZWQtZnVsbCBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciBzaHJpbmstMCAke1xuICAgICAgICAgICAgICAgICAgICBtc2cucm9sZSA9PT0gXCJ1c2VyXCIgPyBcImJnLXByaW1hcnkgdGV4dC1wcmltYXJ5LWZvcmVncm91bmRcIiA6IFwiYmctc2Vjb25kYXJ5XCJcbiAgICAgICAgICAgICAgICAgIH1gfT5cbiAgICAgICAgICAgICAgICAgICAge21zZy5yb2xlID09PSBcInVzZXJcIiA/IDxVc2VyIGNsYXNzTmFtZT1cImgtNSB3LTVcIiAvPiA6IDxCb3QgY2xhc3NOYW1lPVwiaC01IHctNVwiIC8+fVxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17YHAtMyByb3VuZGVkLWxnIHRleHQtc20gd2hpdGVzcGFjZS1wcmUtd3JhcCAke1xuICAgICAgICAgICAgICAgICAgICAgIG1zZy5yb2xlID09PSBcInVzZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgPyBcImJnLXByaW1hcnkgdGV4dC1wcmltYXJ5LWZvcmVncm91bmRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgOiBcImJnLWNhcmQgYm9yZGVyIHNoYWRvdy1zbVwiXG4gICAgICAgICAgICAgICAgICAgIH1gfVxuICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICB7bXNnLmNvbnRlbnR9XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApKX1cbiAgICAgICAgICAgIHtpc0xvYWRpbmcgJiYgKFxuICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGp1c3RpZnktc3RhcnRcIj5cbiAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJiZy1jYXJkIGJvcmRlciBwLTMgcm91bmRlZC1sZyB0ZXh0LXNtIHNoYWRvdy1zbVwiPlxuICAgICAgICAgICAgICAgICAgIFRoaW5raW5nLi4uXG4gICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApfVxuICAgICAgICAgICAgPGRpdiByZWY9e3Njcm9sbFJlZn0gLz5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9TY3JvbGxBcmVhPlxuICAgICAgICBcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJwdC00IG10LTIgZmxleCBnYXAtMlwiPlxuICAgICAgICAgIDxUZXh0YXJlYSBcbiAgICAgICAgICAgIHZhbHVlPXtpbnB1dH1cbiAgICAgICAgICAgIG9uQ2hhbmdlPXsoZTogYW55KSA9PiBzZXRJbnB1dChlLnRhcmdldC52YWx1ZSl9XG4gICAgICAgICAgICBvbktleURvd249eyhlOiBhbnkpID0+IGUua2V5ID09PSBcIkVudGVyXCIgJiYgIWUuc2hpZnRLZXkgJiYgaGFuZGxlU2VuZCgpfVxuICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3QoXCJhaS5wbGFjZWhvbGRlclwiKX1cbiAgICAgICAgICAgIGRpc2FibGVkPXtpc0xvYWRpbmd9XG4gICAgICAgICAgICBjbGFzc05hbWU9XCJmbGV4LTFcIlxuICAgICAgICAgIC8+XG4gICAgICAgICAgPEJ1dHRvbiBvbkNsaWNrPXtoYW5kbGVTZW5kfSBkaXNhYmxlZD17aXNMb2FkaW5nfT5cbiAgICAgICAgICAgIDxTZW5kIGNsYXNzTmFtZT1cImgtNCB3LTRcIiAvPlxuICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvQ2FyZD5cbiAgICA8L2Rpdj5cbiAgKTtcbn1cbiJdLCJmaWxlIjoiRDov5qGM6Z2i56uv5bqU55SocGx1cy9hcHAvc3JjL3BhZ2VzL0FpQWdlbnQudHN4In0=